<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import java.net.URL?>
<?import javafx.scene.chart.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="grafica.ResultDeckController"
            styleClass="app-root">

    <stylesheets>
        <URL value="@MainView.css"/>
        <URL value="@ResultDeckView.css"/>
    </stylesheets>

    <top>
        <HBox styleClass="top-bar" alignment="CENTER_LEFT" spacing="12">
            <Button text="← Indietro" onAction="#back" styleClass="res-back-btn"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="RISULTATO" styleClass="top-title"/>
            <Region HBox.hgrow="ALWAYS"/>
        </HBox>
    </top>

    <center>
        <!-- Scroll globale della pagina -->
        <ScrollPane fitToWidth="true" pannable="true" styleClass="res-scroll">
            <content>
                <VBox alignment="TOP_CENTER" styleClass="page">
                    <VBox spacing="18" styleClass="content-panel">

                        <!-- ====== GA ====== -->
                        <Label text="GA:" styleClass="deck-title"/>

                        <StackPane styleClass="deck-frame">
                            <HBox spacing="10" alignment="CENTER" styleClass="deck-row">

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card0Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card0Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card1Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card1Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card2Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card2Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card3Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card3Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card4Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card4Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card5Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card5Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card6Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card6Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="card7Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="card7Label" styleClass="card-name"/>
                                </StackPane>

                            </HBox>
                        </StackPane>

                        <!-- Toggle Dettagli GA -->
                        <HBox alignment="CENTER_LEFT"
                              spacing="8"
                              styleClass="details-toggle"
                              onMouseClicked="#toggleGADetails">
                            <Label text="Dettagli" styleClass="res-section-title"/>
                            <Label fx:id="gaDetailsArrow" text="▲" styleClass="details-arrow"/>
                        </HBox>

                        <!-- Pannello Dettagli GA -->
                        <VBox fx:id="gaDetailsBox" styleClass="details-box">
                            <Label fx:id="detailsLabel" wrapText="true" styleClass="details-text"/>
                        </VBox>

                        <!-- ====== SA ====== -->
                        <Label text="SA:" styleClass="deck-title"/>

                        <StackPane styleClass="deck-frame">
                            <HBox spacing="10" alignment="CENTER" styleClass="deck-row">

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard0Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard0Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard1Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard1Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard2Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard2Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard3Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard3Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard4Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard4Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard5Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard5Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard6Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard6Label" styleClass="card-name"/>
                                </StackPane>

                                <StackPane styleClass="card-slot-btn">
                                    <ImageView fx:id="SAcard7Img" fitWidth="74" fitHeight="94" preserveRatio="true"/>
                                    <Label fx:id="SAcard7Label" styleClass="card-name"/>
                                </StackPane>

                            </HBox>
                        </StackPane>

                        <!-- Toggle Dettagli SA -->
                        <HBox alignment="CENTER_LEFT"
                              spacing="8"
                              styleClass="details-toggle"
                              onMouseClicked="#toggleSADetails">
                            <Label text="Dettagli" styleClass="res-section-title"/>
                            <Label fx:id="saDetailsArrow" text="▲" styleClass="details-arrow"/>
                        </HBox>

                        <!-- Pannello Dettagli SA -->
                        <VBox fx:id="saDetailsBox" styleClass="details-box">
                            <Label fx:id="SAdetailsLabel" wrapText="true" styleClass="details-text"/>
                        </VBox>

                        <!-- ====== METRICHE (GA vs SA) ====== -->
                        <Label text="METRICHE:" styleClass="deck-title"/>

                        <VBox fx:id="metricsBox" spacing="14" styleClass="details-box">
                            <Label text="Convergenza (g*)" styleClass="res-section-title"/>
                            <Label wrapText="true" styleClass="metrics-caption"
                                   text="Questa metrica indica quando l’algoritmo raggiunge stabilmente una soluzione vicina alla migliore finale. Un valore di g* più basso significa convergenza più rapida; un valore più alto indica che l’algoritmo continua a migliorare più a lungo prima di stabilizzarsi. Il confronto GA vs SA mostra quale metodo arriva prima a risultati stabili." />


                            <BarChart fx:id="convChart" prefHeight="220" animated="false" legendVisible="true" styleClass="metrics-chart">
                                <xAxis>
                                    <CategoryAxis />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="Generazione / Step"/>
                                </yAxis>
                            </BarChart>

                            <Label text="Card Usage CV" styleClass="res-section-title"/>
                            <Label wrapText="true" styleClass="metrics-caption"
                                   text="Il coefficiente di variazione (CV) misura quanto l’uso delle carte è sbilanciato rispetto al pool: valori alti indicano che l’algoritmo tende a riutilizzare spesso le stesse carte (soluzioni più polarizzate), mentre valori più bassi indicano una selezione più uniforme e diversificata. Il confronto GA vs SA evidenzia quale algoritmo produce soluzioni più varie o più concentrate su poche carte." />


                            <BarChart fx:id="cvChart" prefHeight="220" animated="false" legendVisible="true" styleClass="metrics-chart">
                                <xAxis>
                                    <CategoryAxis />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="CV"/>
                                </yAxis>
                            </BarChart>

                        </VBox>


                    </VBox>
                </VBox>
            </content>
        </ScrollPane>
    </center>

    <bottom>
        <HBox styleClass="bottom-bar">
            <Label fx:id="statusLabel" text="" styleClass="bottom-right-label"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="v1.0" styleClass="bottom-right-label"/>
        </HBox>
    </bottom>

</BorderPane>
